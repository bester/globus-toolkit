.TH myproxy-store 1 "2008-12-12" "Globus" "MyProxy"
.SH NAME
myproxy-store \- store end-entity credential for later retrieval
.SH SYNOPSIS
.B myproxy-store 
[
.I options
]
.SH DESCRIPTION
The
.B myproxy-store
command uploads a credential to a
.BR myproxy-server (8)
for later retrieval.
The user must have a valid proxy credential as generated by
.B grid-proxy-init
or retrieved by
.BR myproxy-logon (1)
when running this command.
Unlike 
.BR myproxy-init (1),
this command transfers the private key over the network (over a
private channel).
In the default mode, 
the command will take the credentials found in
.I ~/.globus/usercert.pem
and
.I ~/.globus/userkey.pem
and store them in the
.BR myproxy-server (8)
repository.  Proxy credentials with default lifetime of 12 hours can then be
retrieved by 
.BR myproxy-logon (1)
using the credential passphrase.
The default behavior can be overridden by options specified below.
.PP
The hostname where the 
.BR myproxy-server (8)
is running must be specified by either defining the 
.B MYPROXY_SERVER
environment variable or the
.B -s
option.
.SH OPTIONS
.TP
.B -h, --help
Displays command usage text and exits.
.TP
.B -u, --usage
Displays command usage text and exits.
.TP
.B -v, --verbose
Enables verbose debugging output to the terminal.
.TP
.B -V, --version
Displays version information and exits.
.TP
.BI -s " hostname, " --pshost " hostname"
Specifies the hostname(s) of the myproxy-server(s).  
Multiple hostnames may be specified in a comma-separated list.
This option is required if the
.B MYPROXY_SERVER
environment variable is not defined.  If specified, this option
overrides the
.B MYPROXY_SERVER
environment variable.
.TP
.BI -p " port, " --psport " port"
Specifies the TCP port number of the
.BR myproxy-server (8).
Default: 7512
.TP
.B -l, --username
Specifies the MyProxy account under which the credential should be
stored.  By default, the command uses the value of the
.B LOGNAME
environment variable.
Use this option to specify a different account username on the MyProxy
server.
The MyProxy username need not correspond to a real Unix username.
.TP
.BI -c " filename, " --certfile " filename"
Specifies  the  filename  of  the source certificate.
.TP
.BI -y " filename, " --keyfile " filename"
Specifies the filename of the source private key.
.TP
.BI -t " hours, " --proxy_lifetime " hours"
Specifies the maximum lifetime of credentials retrieved from the
.BR myproxy-server (8)
using the stored credential.  Default: 12 hours
.TP
.B -d, --dn_as_username
Use the certificate subject (DN) as the default username, instead
of the 
.B LOGNAME 
environment variable.
.TP
.B -a, --allow_anonymous_retrievers
Allow credentials to be retrieved with just pass phrase authentication.
By default, only entities with credentials that match the
.BR myproxy-server.config (5)
default retriever policy may retrieve credentials.
This option allows entities without existing credentials to retrieve a
credential using pass phrase authentication by including "anonymous"
in the set of allowed retrievers.  The
.BR myproxy-server.config (5)
server-wide policy must also allow "anonymous" clients for this option
to have an effect.
.TP
.B -A, --allow_anonymous_renewers
Allow credentials to be renewed by any client.
Any client with a valid credential with a subject name that matches
the stored credential may retrieve a new credential from the MyProxy
repository if this option is given.
Since this effectively defeats the purpose of proxy credential
lifetimes, it is not recommended.  It is included only for sake of
completeness.
.TP
.BI -r " dn, " --retrievable_by " dn"
Allow the specified entity to retrieve credentials.  By default, the
argument will be matched against the common name (CN) of the client
(for example: "Jim Basney").  Specify
.B -x 
before this option to match against the full distinguished name (DN)
(for example: "/C=US/O=National Computational Science Alliance/CN=Jim
Basney")
or a regular expression
(for example: "*/CN=Jim Basney|*/CN=James Basney").
.TP
.BI -E " dn, " --retrieve_key " dn"
Allow the specified entity to retrieve end-entity credentials.  By 
default, the argument will be matched against the common name (CN) 
of the client (for example: "Jim Basney").  Specify
.B -x 
before this option to match against the full distinguished name (DN)
(for example: "/C=US/O=National Computational Science Alliance/CN=Jim
Basney")
or a regular expression
(for example: "*/CN=Jim Basney|*/CN=James Basney").
.TP
.BI -R " dn, " --renewable_by " dn"
Allow the specified entity to renew credentials.
By default, the
argument will be matched against the common name (CN) of the client
(for example: "condorg/modi4.ncsa.uiuc.edu").  Specify
.B -x 
before this option to match against the full distinguished name (DN)
(for example: "/C=US/O=National Computational Science
Alliance/CN=condorg/modi4.ncsa.uiuc.edu")
or a regular expression
(for example: "*/CN=server1.ncsa.uiuc.edu|*/CN=server2.ncsa.uiuc.edu").
This option implies 
.B -n
since passphrase authentication is not used for credential renewal.
.TP
.BI -Z " dn, " --retrievable_by_cert " dn"
Allow the specified entity to retrieve credentials without a passphrase.
By default, the
argument will be matched against the common name (CN) of the client
(for example: "Jim Basney").  Specify
.B -x 
before this option to match against the full distinguished name (DN)
(for example: "/C=US/O=National Computational Science Alliance/CN=Jim Basney")
or a regular expression
(for example: "*/CN=Jim Basney|*/CN=James Basney").
This option implies 
.BR -n .
.TP
.B -x, --regex_dn_match
Specifies that the DN used by options 
.B -r
and 
.B -R
will be matched as a regular expression.
.TP
.B -X, --match_cn_only
Specifies that the DN used by options 
.B -r 
and 
.B -R 
will be matched against the Common Name (CN) of the subject.
.TP
.BI -k " name, " --credname " name"
Specifies the credential name.
.TP
.BI -K " description, " --creddesc " description"
Specifies credential description.
.TP
.SH "EXIT STATUS"
0 on success, >0 on error
.SH FILES
.TP
.I ~/.globus/usercert.pem
Default location of the certificate to be stored on the 
.BR myproxy-server .
Use the
.B --certfile
option to override.
.TP
.I ~/.globus/userkey.pem
Default location of the private key to be stored on the
.BR myproxy-server .
Use the
.B --keyfile
option to override.
.TP
.B -T, --trustroots
Retrieve CA certificates directory from server (if available) to store
in the location specified by the
.B X509_CERT_DIR
environment variable if set or
.I /etc/grid-security/certificates
if running as root or
.I ~/.globus/certificates
if running as non-root.
.SH ENVIRONMENT
.TP
.B MYPROXY_SERVER
Specifies the hostname(s) where the
.BR myproxy-server (8)
is running.  This environment variable can be used in place of the 
.B -s
option.
.TP
.B MYPROXY_SERVER_PORT
Specifies the port where the
.BR myproxy-server (8)
is running.  This environment variable can be used in place of the 
.B -p
option.
.TP
.B MYPROXY_SERVER_DN
Specifies the distinguished name (DN) of the 
.BR myproxy-server (8).
All MyProxy client programs authenticate the server's identity.
By default, MyProxy servers run with host credentials, so the MyProxy
client programs expect the server to have a distinguished name with
"/CN=host/<fqhn>" or "/CN=myproxy/<fqhn>" or "/CN=<fqhn>"
(where <fqhn> is the fully-qualified hostname of
the server).  If the server is running with some other DN, you can set
this environment variable to tell the MyProxy clients to accept the
alternative DN.
.TP
.B MYPROXY_TCP_PORT_RANGE
Specifies a range of valid port numbers 
in the form "min,max"
for the client side of the network connection to the server.
By default, the client will bind to any available port.
Use this environment variable to restrict the ports used to
a range allowed by your firewall.
If unset, MyProxy will follow the setting of the
.B GLOBUS_TCP_PORT_RANGE
environment variable.
.TP
.B X509_USER_CERT
Specifies a non-standard location for the certificate to be used for
authentication to the 
.BR myproxy-server (8).
Also specifies the location for the certificate to be stored
unless the
.B -c
option is given.
.TP
.B X509_USER_KEY
Specifies a non-standard location for the private key to be used for
authentication to the 
.BR myproxy-server (8).
Also specifies the location for the private key to
be stored unless the
.B -y
option is given.
.TP
.B X509_USER_PROXY
Specifies a non-standard location for the proxy credential to be used
for authentication to the 
.BR myproxy-server (8).
.TP
.B X509_CERT_DIR
Specifies a non-standard location for the CA certificates directory.
.SH AUTHORS
Bill Baker,
Jim Basney,
Shiva Shankar Chetan,
Patrick Duda,
Terry Fleury,
Jarek Gawor,
Monte Goode,
Daniel Kouril,
Zhenmin Li,
Neill Miller,
Jason Novotny,
Miroslav Ruda,
Benjamin Temko,
and Von Welch
.SH "SEE ALSO"
.BR myproxy-change-pass-phrase (1),
.BR myproxy-destroy (1),
.BR myproxy-get-trustroots (1),
.BR myproxy-info (1),
.BR myproxy-logon (1),
.BR myproxy-retrieve (1),
.BR myproxy-server.config (5),
.BR myproxy-admin-adduser (8),
.BR myproxy-admin-change-pass (8),
.BR myproxy-admin-load-credential (8),
.BR myproxy-admin-query (8),
.BR myproxy-server (8)
.BR myproxy-retrieve (1)
